
Running configs.
{'root_path': 'datasets', 'dataset': 'eurosat', 'shots': 16, 'backbone': 'RN50', 'n_prompt_tokens': 4, 'intrinsic_dim': 512, 'budget': 8000, 'bound': 5, 'alpha': 1, 'popsize': 40, 'parallel': False, 'print_every': 50, 'eval_every': 100, 'n': 1, 'batch_size': 256, 'std': 1, 'weight': 0.01, 'train_epoch': 20, 'subsample_classes': 'all', 'seed': 1}

Preparing dataset.
Reading split from /raid0-data/yifan/datasets/eurosat/split_zhou_EuroSAT.json
Creating a 16-shot dataset

Loading visual features and labels from test set.
Initial context: "a photo of a"
Number of context words (tokens): 4
Population Size: 40
Serial Evaluation.
Printing trainable parameters
Printing to verify trainable parameters
name input_param param.shape: torch.Size([40, 512])
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 512/512 [00:07<00:00, 69.11it/s]
/home/yifanyang/miniconda3/envs/vlm/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:224: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(
Steps: 0 	 Acc:48.23456790123457 	 Loss:0
merge the parameter at step 1
name input_param param.shape: torch.Size([512]) grad_tmp[name].shape: torch.Size([40, 512])
Steps: 100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 1000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 1100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 1200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 1300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 1400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 1500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 1600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 1700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 1800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 1900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 2000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 2100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 2200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 2300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 2400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 2500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 2600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 2700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 2800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 2900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 3000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 3100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 3200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 3300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 3400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 3500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 3600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 3700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 3800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 3900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 4000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 4100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 4200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 4300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 4400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 4500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 4600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 4700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 4800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 4900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 5000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 5100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 5200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 5300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 5400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 5500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 5600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 5700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 5800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 5900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 6000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 6100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 6200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 6300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 6400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 6500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 6600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 6700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 6800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 6900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 7000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 7100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 7200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 7300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 7400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 7500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 7600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 7700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 7800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 7900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 8000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 8100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 8200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 8300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 8400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 8500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 8600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 8700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 8800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 8900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 9000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 9100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 9200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 9300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 9400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 9500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 9600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 9700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 9800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 9900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 10000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 10100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 10200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 10300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 10400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 10500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 10600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 10700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 10800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 10900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 11000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 11100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 11200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 11300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 11400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 11500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 11600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 11700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 11800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 11900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 12000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 12100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 12200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 12300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 12400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 12500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 12600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 12700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 12800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 12900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 13000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 13100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 13200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 13300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 13400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 13500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 13600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 13700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 13800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 13900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 14000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 14100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 14200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 14300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 14400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 14500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 14600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 14700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 14800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 14900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 15000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 15100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 15200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 15300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 15400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 15500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 15600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 15700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 15800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 15900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 16000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 16100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 16200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 16300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 16400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 16500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 16600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 16700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 16800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 16900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 17000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 17100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 17200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 17300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 17400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 17500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 17600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 17700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 17800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 17900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 18000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 18100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 18200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 18300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 18400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 18500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 18600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 18700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 18800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 18900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 19000 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 19100 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 19200 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 19300 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 19400 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 19500 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 19600 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 19700 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 19800 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Steps: 19900 	 Acc:48.20987654320987 	 Loss:tensor(1.6329, device='cuda:0')
Dataset: eurosat
Backbone: RN50
Results on shots: [1, 2, 4, 8, 16]
Results on seed 1: [48.20987654320987]
