
Running configs.
{'root_path': 'datasets', 'dataset': 'eurosat', 'shots': 16, 'backbone': 'RN50', 'n_prompt_tokens': 4, 'intrinsic_dim': 512, 'budget': 8000, 'bound': 5, 'alpha': 1, 'popsize': 40, 'parallel': False, 'print_every': 50, 'eval_every': 100, 'n': 1, 'batch_size': 256, 'std': 1, 'weight': 0.01, 'train_epoch': 20, 'subsample_classes': 'all', 'seed': 1}

Preparing dataset.
Reading split from /raid0-data/yifan/datasets/eurosat/split_zhou_EuroSAT.json
Creating a 16-shot dataset

Loading visual features and labels from test set.
Initial context: "a photo of a"
Number of context words (tokens): 4
Population Size: 40
Serial Evaluation.
Printing trainable parameters
Printing to verify trainable parameters
name input_param param.shape: torch.Size([40, 512])
100%|██████████████████████████| 512/512 [00:07<00:00, 70.21it/s]
/home/yifanyang/miniconda3/envs/vlm/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:224: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(
Steps: 0 	 Acc:48.23456790123457 	 Loss:0
100%|██████████████████████████| 512/512 [00:07<00:00, 70.87it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.92it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.69it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 69.53it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.37it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 69.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 512/512 [00:07<00:00, 70.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 512/512 [00:07<00:00, 69.89it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 512/512 [00:07<00:00, 70.76it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 512/512 [00:07<00:00, 71.00it/s]
Steps: 10 	 Acc:59.28395061728395 	 Loss:0
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 512/512 [00:07<00:00, 70.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 512/512 [00:07<00:00, 70.32it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 512/512 [00:07<00:00, 70.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 512/512 [00:07<00:00, 70.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 512/512 [00:07<00:00, 70.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 512/512 [00:07<00:00, 70.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 512/512 [00:07<00:00, 70.02it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.81it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.94it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.59it/s]
Steps: 20 	 Acc:58.08641975308642 	 Loss:0
100%|██████████████████████████| 512/512 [00:07<00:00, 69.88it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.51it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.76it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.46it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.51it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.65it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.68it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.97it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.24it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.81it/s]
Steps: 30 	 Acc:65.34567901234568 	 Loss:0
100%|██████████████████████████| 512/512 [00:07<00:00, 70.61it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.53it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.49it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.21it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.26it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.56it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.19it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.19it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.68it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.18it/s]
Steps: 40 	 Acc:70.23456790123457 	 Loss:0
100%|██████████████████████████| 512/512 [00:07<00:00, 70.92it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.87it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.54it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 69.95it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.69it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.97it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.02it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.46it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.54it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.52it/s]
Steps: 50 	 Acc:67.8395061728395 	 Loss:0
100%|██████████████████████████| 512/512 [00:07<00:00, 70.71it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.66it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.79it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.73it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.87it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.01it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.97it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.48it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.68it/s]
100%|██████████████████████████| 512/512 [00:07<00:00, 70.61it/s]
Steps: 60 	 Acc:67.87654320987654 	 Loss:0
100%|██████████████████████████| 512/512 [00:07<00:00, 70.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 512/512 [00:07<00:00, 70.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 512/512 [00:07<00:00, 70.71it/s]
 17%|█████████████████████████████████████████▏                                                                                                                                                                                                           | 86/512 [00:01<00:06, 70.90it/s]
