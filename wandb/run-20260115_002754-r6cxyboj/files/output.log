
Running configs.
{'root_path': 'datasets', 'dataset': 'eurosat', 'shots': 16, 'backbone': 'RN50', 'n_prompt_tokens': 4, 'intrinsic_dim': 512, 'budget': 8000, 'bound': 5, 'alpha': 1, 'popsize': 40, 'parallel': False, 'print_every': 50, 'eval_every': 100, 'n': 1, 'batch_size': 256, 'std': 1, 'weight': 0.01, 'train_epoch': 20, 'subsample_classes': 'all', 'seed': 1}

Preparing dataset.
Reading split from /raid0-data/yifan/datasets/eurosat/split_zhou_EuroSAT.json
Creating a 16-shot dataset

Loading visual features and labels from test set.
Initial context: "a photo of a"
Number of context words (tokens): 4
Population Size: 40
Serial Evaluation.
Printing trainable parameters
Printing to verify trainable parameters
name input_param param.shape: torch.Size([40, 512])
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
    1     40 1.678667664527893e+00 1.0e+00 3.93e-01  4e-01  4e-01 0:00.4
Checkpoint saved at step 0 to /raid0-data/yifan/mllm/checkpoints_vit/eurosat-rho-0.1-std-1-sigma-0.4-zo-eps-cge-1e-05-smo-none_checkpoint_step_0.pt
/home/yifanyang/miniconda3/envs/vlm/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:224: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(
Steps: 0 	 Acc:46.95061728395062 	 Loss:0
    2     80 1.578889966011047e+00 1.0e+00 3.86e-01  4e-01  4e-01 0:02.2
Steps: 1 	 Acc:44.27160493827161 	 Loss:0
    3    120 1.524325728416443e+00 1.0e+00 3.80e-01  4e-01  4e-01 0:02.5
Steps: 2 	 Acc:47.91358024691358 	 Loss:0
    4    160 1.489840388298035e+00 1.0e+00 3.75e-01  4e-01  4e-01 0:02.9
Steps: 3 	 Acc:52.75308641975309 	 Loss:0
    5    200 1.500890731811523e+00 1.0e+00 3.70e-01  4e-01  4e-01 0:03.3
Steps: 4 	 Acc:55.03703703703704 	 Loss:0
    6    240 1.467273592948914e+00 1.0e+00 3.66e-01  4e-01  4e-01 0:03.6
Steps: 5 	 Acc:58.41975308641975 	 Loss:0
    7    280 1.496462106704712e+00 1.0e+00 3.62e-01  4e-01  4e-01 0:04.0
Steps: 6 	 Acc:53.79012345679013 	 Loss:0
    8    320 1.446965456008911e+00 1.0e+00 3.58e-01  4e-01  4e-01 0:04.3
Steps: 7 	 Acc:57.23456790123457 	 Loss:0
    9    360 1.440359711647034e+00 1.0e+00 3.55e-01  4e-01  4e-01 0:04.7
Steps: 8 	 Acc:59.39506172839506 	 Loss:0
   10    400 1.391101479530334e+00 1.0e+00 3.52e-01  4e-01  4e-01 0:05.1
Steps: 9 	 Acc:57.382716049382715 	 Loss:0
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   11    440 1.388980150222778e+00 1.0e+00 3.49e-01  3e-01  3e-01 0:05.4
Steps: 10 	 Acc:57.80246913580247 	 Loss:0
   12    480 1.424871325492859e+00 1.0e+00 3.47e-01  3e-01  3e-01 0:05.7
Steps: 11 	 Acc:59.98765432098765 	 Loss:0
   13    520 1.387871265411377e+00 1.0e+00 3.45e-01  3e-01  3e-01 0:06.1
Steps: 12 	 Acc:62.58024691358025 	 Loss:0
   14    560 1.347641229629517e+00 1.0e+00 3.43e-01  3e-01  3e-01 0:06.5
Steps: 13 	 Acc:59.55555555555556 	 Loss:0
   15    600 1.354120492935181e+00 1.0e+00 3.41e-01  3e-01  3e-01 0:06.8
Steps: 14 	 Acc:55.91358024691358 	 Loss:0
   16    640 1.305599331855774e+00 1.0e+00 3.39e-01  3e-01  3e-01 0:07.2
Steps: 15 	 Acc:56.82716049382716 	 Loss:0
   17    680 1.323516368865967e+00 1.0e+00 3.37e-01  3e-01  3e-01 0:07.6
Steps: 16 	 Acc:62.839506172839506 	 Loss:0
   18    720 1.309748172760010e+00 1.0e+00 3.35e-01  3e-01  3e-01 0:07.9
Steps: 17 	 Acc:60.23456790123457 	 Loss:0
   19    760 1.280549287796021e+00 1.0e+00 3.34e-01  3e-01  3e-01 0:08.3
Steps: 18 	 Acc:65.92592592592592 	 Loss:0
   20    800 1.269531846046448e+00 1.0e+00 3.33e-01  3e-01  3e-01 0:08.7
Steps: 19 	 Acc:66.67901234567901 	 Loss:0
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   21    840 1.239821195602417e+00 1.0e+00 3.32e-01  3e-01  3e-01 0:09.0
Steps: 20 	 Acc:66.11111111111111 	 Loss:0
   22    880 1.260440349578857e+00 1.0e+00 3.31e-01  3e-01  3e-01 0:09.4
Steps: 21 	 Acc:66.29629629629629 	 Loss:0
   23    920 1.260374069213867e+00 1.0e+00 3.30e-01  3e-01  3e-01 0:09.7
Steps: 22 	 Acc:65.30864197530865 	 Loss:0
   24    960 1.215041399002075e+00 1.0e+00 3.29e-01  3e-01  3e-01 0:10.1
Steps: 23 	 Acc:64.81481481481481 	 Loss:0
   25   1000 1.246536970138550e+00 1.0e+00 3.28e-01  3e-01  3e-01 0:10.5
Steps: 24 	 Acc:65.14814814814815 	 Loss:0
   26   1040 1.195220232009888e+00 1.0e+00 3.27e-01  3e-01  3e-01 0:10.8
Steps: 25 	 Acc:65.44444444444444 	 Loss:0
   27   1080 1.210335016250610e+00 1.0e+00 3.26e-01  3e-01  3e-01 0:11.2
Steps: 26 	 Acc:64.09876543209876 	 Loss:0
   28   1120 1.200932621955872e+00 1.0e+00 3.26e-01  3e-01  3e-01 0:11.6
Steps: 27 	 Acc:63.358024691358025 	 Loss:0
   29   1160 1.171010136604309e+00 1.0e+00 3.25e-01  3e-01  3e-01 0:11.9
Steps: 28 	 Acc:63.39506172839506 	 Loss:0
   30   1200 1.134503245353699e+00 1.0e+00 3.25e-01  3e-01  3e-01 0:12.3
Steps: 29 	 Acc:64.53086419753086 	 Loss:0
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   31   1240 1.164641380310059e+00 1.0e+00 3.24e-01  3e-01  3e-01 0:12.7
Steps: 30 	 Acc:64.4320987654321 	 Loss:0
   32   1280 1.127385020256042e+00 1.0e+00 3.24e-01  3e-01  3e-01 0:13.0
Steps: 31 	 Acc:64.8395061728395 	 Loss:0
   33   1320 1.123448848724365e+00 1.0e+00 3.23e-01  3e-01  3e-01 0:13.4
Steps: 32 	 Acc:63.22222222222222 	 Loss:0
   34   1360 1.110422253608704e+00 1.0e+00 3.23e-01  3e-01  3e-01 0:13.8
Steps: 33 	 Acc:64.35802469135803 	 Loss:0
   35   1400 1.112894058227539e+00 1.0e+00 3.23e-01  3e-01  3e-01 0:14.1
Steps: 34 	 Acc:65.54320987654322 	 Loss:0
   36   1440 1.103379607200623e+00 1.0e+00 3.22e-01  3e-01  3e-01 0:14.4
Steps: 35 	 Acc:67.32098765432099 	 Loss:0
   37   1480 1.094625353813171e+00 1.0e+00 3.22e-01  3e-01  3e-01 0:14.8
Steps: 36 	 Acc:68.64197530864197 	 Loss:0
   38   1520 1.111842036247253e+00 1.0e+00 3.22e-01  3e-01  3e-01 0:15.1
Steps: 37 	 Acc:69.24691358024691 	 Loss:0
   39   1560 1.089507937431335e+00 1.0e+00 3.22e-01  3e-01  3e-01 0:15.5
Steps: 38 	 Acc:67.90123456790124 	 Loss:0
   40   1600 1.091258764266968e+00 1.0e+00 3.22e-01  3e-01  3e-01 0:15.9
Steps: 39 	 Acc:68.5925925925926 	 Loss:0
Iterat #Fevals   function value  axis ratio  sigma  min&max std  t[m:s]
   41   1640 1.092368721961975e+00 1.0e+00 3.22e-01  3e-01  3e-01 0:16.2
Steps: 40 	 Acc:66.53086419753086 	 Loss:0
   42   1680 1.085457444190979e+00 1.0e+00 3.22e-01  3e-01  3e-01 0:16.6
Steps: 41 	 Acc:67.33333333333333 	 Loss:0
   43   1720 1.053229570388794e+00 1.0e+00 3.22e-01  3e-01  3e-01 0:17.0
Steps: 42 	 Acc:67.71604938271605 	 Loss:0
   44   1760 1.066562652587891e+00 1.0e+00 3.22e-01  3e-01  3e-01 0:17.3
Steps: 43 	 Acc:67.45679012345678 	 Loss:0
